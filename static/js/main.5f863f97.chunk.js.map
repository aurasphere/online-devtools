{"version":3,"sources":["components/header.js","pages/jwe-decrypter.js","index.js"],"names":["Header","props","className","text","jose","require","JSONPretty","JSONPrettyTheme","decodeToken","token","key","a","split","length","tokenType","decodeJwt","decodedToken","decodedHeaders","isError","decodeJwe","payload","headers","tokenComponents","JSON","stringify","parse","atob","console","log","JWK","asKey","k","util","base64url","encode","kty","jwkKey","JWE","createDecrypt","decrypt","decrypted","toString","header","JweDecrypterPage","useState","setTokenType","decodedTokenPayload","setDecodedTokenPayload","decodedTokenHeaders","setDecodedTokenHeaders","setToken","setKey","errorKey","setErrorKey","recomputeToken","class","href","for","id","onChange","e","target","value","tokenInputClass","rows","placeholder","toUpperCase","type","data","theme","ReactDOM","render","StrictMode","path","document","getElementById"],"mappings":"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","file":"static/js/main.5f863f97.chunk.js","sourcesContent":["function Header(props) {\r\n    return (\r\n        <div className=\"flex-fill\">\r\n            <div className=\"d-flex justify-content-center bg-primary p-4\">\r\n                <h3 className=\"text-light\">{props.text}</h3>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Header;","import React, { useState } from 'react';\r\n\r\nimport Header from \"../components/header\";\r\n\r\nvar jose = require('node-jose');\r\nvar JSONPretty = require('react-json-pretty');\r\nvar JSONPrettyTheme = require('react-json-pretty/dist/acai');\r\n\r\nfunction JweDecrypterPage() {\r\n    const [tokenType, setTokenType] = useState(\"\");\r\n    const [decodedTokenPayload, setDecodedTokenPayload] = useState(\"\");\r\n    const [decodedTokenHeaders, setDecodedTokenHeaders] = useState(\"\");\r\n    const [token, setToken] = useState(\"\");\r\n    const [key, setKey] = useState(\"\");\r\n    const [errorKey, setErrorKey] = useState(false);\r\n\r\n    const recomputeToken = async (token, key) => {\r\n        const [tokenType, decodedToken, decodedHeaders, errorKey] = await decodeToken(token, key);\r\n        console.log(tokenType)\r\n        console.log(decodedToken)\r\n        setTokenType(tokenType);\r\n        setDecodedTokenPayload(decodedToken);\r\n        setDecodedTokenHeaders(decodedHeaders);\r\n        setErrorKey(errorKey);\r\n    }\r\n\r\n    const onTokenChange = e => {\r\n        const token = e.target.value;\r\n        setToken(token);\r\n        recomputeToken(token, key);\r\n    }\r\n    const onKeyChange = e => {\r\n        const key = e.target.value;\r\n        setKey(key);\r\n        recomputeToken(token, key);\r\n    }\r\n\r\n    const tokenInputClass = () => {\r\n        switch (tokenType) {\r\n            case \"INVALID\": return \"is-invalid\";\r\n            case \"JWT\":\r\n                if (errorKey) {\r\n                    return \"is-invalid\";\r\n                } else {\r\n                    return \"is-valid\";\r\n                }\r\n            case \"JWE\": return \"is-valid\";\r\n            default: return \"\";\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div >\r\n            <Header text=\"JWT/JWE Decrypter\" />\r\n            <form class=\"p-5\">\r\n                <p>Insert a JWE token and the key to decrypt them. All the operations are performed in your browser and no data is sent anywhere. The source code <a href=\"https://github.com/aurasphere/online-devtools\">is available on GitHub.</a></p>\r\n                <div class=\"form-group\">\r\n                    <label for=\"jwe\">JWT/JWE</label>\r\n                    <textarea id=\"jwe\" onChange={onTokenChange}\r\n                        className={`form-control ${tokenInputClass()}`}\r\n                        rows=\"5\" placeholder=\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJNWS1BUFAiLCJjbGFpbS0xIjoidmFsdWUtMSJ9.6Hv6cDrcgR3Lx74VNtVBA4dcl0KCTN9GBlmaqmaM1_w\" />\r\n                    <div class=\"valid-feedback\">{tokenType}</div>\r\n                    <div class=\"invalid-feedback\">INVALID {(tokenType && tokenType !== \"INVALID\") ? tokenType.toUpperCase() : \"TOKEN\"}</div>\r\n                    <br />\r\n                    {tokenType !== \"JWT\" &&\r\n                        <div>\r\n                            <label for=\"key\">Key</label>\r\n                            <input id=\"key\" type=\"text\" onChange={onKeyChange}\r\n                                className={`form-control ${errorKey ? \"is-invalid\" : \"\"}`} placeholder=\"ncLcTSiOET5XteiwCNbnSZJUtGHDxt22\" />\r\n                            <div class=\"invalid-feedback\">INVALID KEY OR TOKEN</div>\r\n                            <br />\r\n                            <br />\r\n                        </div>\r\n                    }\r\n                    {(decodedTokenPayload || decodedTokenHeaders) &&\r\n                        <div>\r\n                            <div class=\"row justify-content-center\">\r\n                                <h3>Decrypted token</h3>\r\n                            </div>\r\n                            <div class=\"row justify-content-center\">\r\n                                <div class=\"col-md-5 col-sm-12 p-0\">\r\n                                    <h4 class=\"text-danger\">Headers</h4>\r\n                                    <JSONPretty data={decodedTokenHeaders} theme={JSONPrettyTheme}></JSONPretty>\r\n                                </div>\r\n                                <div class=\"col-1\"></div>\r\n                                <div class=\"col-md-5 col-sm-12 p-0\">\r\n                                    <h4 class=\"text-info\">Payload</h4>\r\n                                    <JSONPretty data={decodedTokenPayload} theme={JSONPrettyTheme}></JSONPretty>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    }\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n\r\nasync function decodeToken(token, key) {\r\n    if (token === \"\") {\r\n       return [\"\", \"\", \"\", false];\r\n    }\r\n    let tokenType;\r\n    let decodedToken;\r\n    let decodedHeaders;\r\n    let isError;\r\n    switch (token.split(\".\").length) {\r\n        case 3:\r\n            tokenType = \"JWT\";\r\n            [decodedToken, decodedHeaders, isError] = await decodeJwt(token);\r\n            break;\r\n        case 5:\r\n            tokenType = \"JWE\";\r\n            [decodedToken, decodedHeaders, isError] = await decodeJwe(token, key);\r\n            break;\r\n        default:\r\n            tokenType = \"INVALID\";\r\n            break;\r\n    }\r\n    return [tokenType, decodedToken, decodedHeaders, isError];\r\n}\r\n\r\nasync function decodeJwt(token) {\r\n    let payload = \"\";\r\n    let headers = \"\";\r\n    let isError = false;\r\n    const tokenComponents = token.split(\".\");\r\n    try {\r\n        headers = JSON.stringify(JSON.parse(atob(tokenComponents[0])));\r\n        payload = JSON.stringify(JSON.parse(atob(tokenComponents[1])));\r\n    } catch (err) {\r\n        console.log(\"Error during JWT decoding: \" + err);\r\n        return [\"\", \"\", true];\r\n    }\r\n\r\n    return [payload, headers, isError];\r\n}\r\n\r\nasync function decodeJwe(token, key) {\r\n    const jwkKey = await jose.JWK.asKey({ k: jose.util.base64url.encode(key), kty: \"oct\" });\r\n    let payload = \"\";\r\n    let headers = \"\";\r\n    let isError = false;\r\n    try {\r\n        const decrypted = await jose.JWE.createDecrypt(jwkKey).decrypt(token);\r\n        payload = decrypted.payload.toString();\r\n        headers = decrypted.header;\r\n    } catch (err) {\r\n        console.log(\"Error: is the key wrong? \" + err);\r\n        return [\"\", \"\", true];\r\n    }\r\n\r\n    return [payload, headers, isError];\r\n}\r\n\r\nexport default JweDecrypterPage;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport JweDecrypterPage from './pages/jwe-decrypter';\r\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Router>\r\n      <Switch>\r\n        <Route path=\"/jwe-decrypter\">\r\n          <JweDecrypterPage />\r\n        </Route>\r\n        <Route path=\"/\">\r\n          <JweDecrypterPage />\r\n        </Route>\r\n      </Switch>\r\n    </Router>\r\n  </React.StrictMode >,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}