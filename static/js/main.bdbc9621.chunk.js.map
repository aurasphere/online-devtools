{"version":3,"sources":["components/header.js","pages/jwe-decrypter.js","index.js"],"names":["Header","props","className","text","jose","require","JSONPretty","JSONPrettyTheme","decodeToken","token","key","a","split","length","tokenType","decodeJwt","decodedToken","decodeJwe","decodedHeaders","isError","payload","protectedHeader","JWK","asKey","k","util","base64url","encode","kty","jwkKey","headers","JWE","createDecrypt","decrypt","decrypted","console","log","toString","header","JweDecrypterPage","useState","setTokenType","decodedTokenPayload","setDecodedTokenPayload","decodedTokenHeaders","setDecodedTokenHeaders","setToken","setKey","errorKey","setErrorKey","recomputeToken","class","href","for","id","onChange","e","target","value","tokenInputClass","rows","placeholder","type","data","theme","ReactDOM","render","StrictMode","path","document","getElementById"],"mappings":"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","file":"static/js/main.bdbc9621.chunk.js","sourcesContent":["function Header(props) {\r\n    return (\r\n        <div className=\"flex-fill\">\r\n            <div className=\"d-flex justify-content-center bg-primary p-4\">\r\n                <h3 className=\"text-light\">{props.text}</h3>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Header;","import React, { useState } from 'react';\r\n\r\nimport Header from \"../components/header\";\r\nvar jose = require('node-jose');\r\nvar JSONPretty = require('react-json-pretty');\r\nvar JSONPrettyTheme = require('react-json-pretty/dist/acai');\r\n\r\nfunction JweDecrypterPage() {\r\n    const [tokenType, setTokenType] = useState(\"\");\r\n    const [decodedTokenPayload, setDecodedTokenPayload] = useState(\"\");\r\n    const [decodedTokenHeaders, setDecodedTokenHeaders] = useState(\"\");\r\n    const [token, setToken] = useState(\"\");\r\n    const [key, setKey] = useState(\"\");\r\n    const [errorKey, setErrorKey] = useState(false);\r\n\r\n    const recomputeToken = async (token, key) => {\r\n        const [tokenType, decodedToken, decodedHeaders, errorKey] = await decodeToken(token, key);\r\n        console.log(tokenType)\r\n        console.log(decodedToken)\r\n        setTokenType(tokenType);\r\n        setDecodedTokenPayload(decodedToken);\r\n        setDecodedTokenHeaders(decodedHeaders);\r\n        setErrorKey(errorKey);\r\n    }\r\n\r\n    const onTokenChange = e => {\r\n        const token = e.target.value;\r\n        setToken(token);\r\n        recomputeToken(token, key);\r\n    }\r\n    const onKeyChange = e => {\r\n        const key = e.target.value;\r\n        setKey(key);\r\n        recomputeToken(token, key);\r\n    }\r\n\r\n    const tokenInputClass = () => {\r\n        switch (tokenType) {\r\n            case \"INVALID\": return \"is-invalid\";\r\n            case \"JWT\":\r\n            case \"JWE\": return \"is-valid\";\r\n            default: return \"\";\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div >\r\n            <Header text=\"JWT/JWE Decrypter\" />\r\n            <form class=\"p-5\">\r\n                <p>Insert a JWE token and the key to decrypt them. All the operations are performed in your browser and no data is sent anywhere. The source code <a href=\"https://github.com/aurasphere/online-devtools\">is available on GitHub.</a></p>\r\n                <div class=\"form-group\">\r\n                    <label for=\"jwe\">JWT/JWE</label>\r\n                    <textarea id=\"jwe\" onChange={onTokenChange}\r\n                        className={`form-control ${tokenInputClass()}`}\r\n                        rows=\"5\" placeholder=\"JWT/JWE\" />\r\n                    <div class=\"valid-feedback\">{tokenType}</div>\r\n                    <div class=\"invalid-feedback\">INVALID TOKEN</div>\r\n                    <label for=\"key\">Key</label>\r\n                    <input id=\"key\" type=\"text\" onChange={onKeyChange}\r\n                        className={`form-control ${errorKey ? \"is-invalid\" : \"\"}`} placeholder=\"Key\" />\r\n                    <div class=\"invalid-feedback\">INVALID KEY</div>\r\n                    <br />\r\n                    <br />\r\n                    {(decodedTokenPayload || decodedTokenHeaders) &&\r\n                        <div>\r\n                            <div class=\"row justify-content-center\">\r\n                                <h3>Decrypted token</h3>\r\n                            </div>\r\n                            <div class=\"row justify-content-center\">\r\n                                <div class=\"col-md-5 col-sm-12 p-0\">\r\n                                    <h4 class=\"text-danger\">Headers</h4>\r\n                                    <JSONPretty data={decodedTokenHeaders} theme={JSONPrettyTheme}></JSONPretty>\r\n                                </div>\r\n                                <div class=\"col-1\"></div>\r\n                                <div class=\"col-md-5 col-sm-12 p-0\">\r\n                                    <h4 class=\"text-info\">Payload</h4>\r\n                                    <JSONPretty data={decodedTokenPayload} theme={JSONPrettyTheme}></JSONPretty>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    }\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n\r\nasync function decodeToken(token, key) {\r\n    let tokenType;\r\n    let decodedToken;\r\n    let decodedHeaders;\r\n    let isError;\r\n    switch (token.split(\".\").length) {\r\n        case 3:\r\n            tokenType = \"JWT\";\r\n            decodedToken = await decodeJwt(token, key);\r\n            break;\r\n        case 5:\r\n            tokenType = \"JWE\";\r\n            [decodedToken, decodedHeaders, isError] = await decodeJwe(token, key);\r\n            break;\r\n        default:\r\n            tokenType = \"INVALID\";\r\n            break;\r\n    }\r\n    return [tokenType, decodedToken, decodedHeaders, isError];\r\n}\r\n\r\nasync function decodeJwt(token, key) {\r\n    const { payload, protectedHeader } = []\r\n        ;\r\n    //      rsa_key = Jose.Utils.importRsaPublicKey(rsa_key, \"RSA-OAEP-256\");\r\n    //       encrypt = new JoseJWE.Encrypter(crypto , rsa_key);\r\n    //await jwtDecrypt(token, key);\r\n    return payload;\r\n}\r\n\r\nasync function decodeJwe(token, key) {\r\n    const jwkKey = await jose.JWK.asKey({ k: jose.util.base64url.encode(key), kty: \"oct\" });\r\n    let payload = \"\";\r\n    let headers = \"\";\r\n    let isError = false;\r\n    try {\r\n        const decrypted = await jose.JWE.createDecrypt(jwkKey).decrypt(token);\r\n        console.log(decrypted);\r\n        payload = decrypted.payload.toString()\r\n        headers = decrypted.header\r\n    } catch (err) {\r\n        isError = true;\r\n        console.log(\"Error: is the key wrong? \" + err);\r\n    }\r\n\r\n    return [payload, headers, isError];\r\n}\r\n\r\nexport default JweDecrypterPage;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport JweDecrypterPage from './pages/jwe-decrypter';\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router>\n      <Switch>\n        <Route path=\"/jwe-decrypter\">\n          <JweDecrypterPage />\n        </Route>\n        <Route path=\"/\">\n          <JweDecrypterPage />\n        </Route>\n      </Switch>\n    </Router>\n  </React.StrictMode >,\n  document.getElementById('root')\n);"],"sourceRoot":""}